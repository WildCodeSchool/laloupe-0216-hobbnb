<div class="navbar-fixed hide-on-med-and-down">
    <nav>
        <div class="nav-wrapper search-nav">
            <ul class="left">
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown' href='javascript:void(0);' data-hover="true" data-beloworigin="true" data-alignment="bottom" data-activates='hobbiesDropdown' dropdown>
                            <span class="search_dropdown_label">Vos hobbies ?</span>
                            <span class="search_dropdown_selectedValues" ng-hide="selectedHobbies.length > 0">Tous</span>
                            <span class="search_dropdown_selectedValues" ng-repeat='hobby in selectedHobbies | limitTo:3'><img src='./assets/hobbies/{{hobby}}.png' width='15px' height='15px'/></span>
                            <span class="search_dropdown_selectedValues" ng-show="selectedHobbies.length > 3">...</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                        <ul id='hobbiesDropdown' class='dropdown-content'>
                            <li ng-repeat="hobby in hobbiesListing" ng-click="toggleSelectedHobby(hobby)">
                                <span>
                                    <input type="checkbox" value="{{hobby}}" ng-click="toggleSelectedHobby(hobby)" ng-checked="selectedHobbies.indexOf(hobby) > -1" id="{{hobby}}"/>
                                    <label for="{{hobby}}">{{hobby}}</label>
                                </span>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown' href='javascript:void(0);' data-hover="true" data-beloworigin="true" data-alignment="bottom" data-activates='displayDropdown' dropdown>
                            <span class="search_dropdown_label">Afficher</span>
                            <span class="search_dropdown_selectedValues" ng-hide="showPlace || showSpot">Tous</span>
                            <span class="search_dropdown_selectedValues" ng-show="showPlace"><img src='/assets/search/locateHost.png' width='15px' height='15px'/>
                                Hébergements</span>
                            <span class="search_dropdown_selectedValues" ng-show="showSpot"><img src='/assets/search/locateSpot.png' width='15px' height='15px'/>
                                Spots</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                        <ul id='displayDropdown' class='dropdown-content'>
                            <li ng-click="showPlace=!showPlace">
                                <span>
                                    <input type="checkbox" ng-model="showPlace" ng-checked="showPlace" id="showPlace"/>
                                    <label for="showPlace">Hébergements</label>
                                </span>
                            </li>
                            <li ng-click="showSpot=!showSpot">
                                <span>
                                    <input type="checkbox" ng-model="showSpot" ng-checked="showSpot" id="showSpot"/>
                                    <label for="showSpot">Spots</label>
                                </span>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
            <ul class="right">
                <li ng-show="showPlace">
                    <div class="search_element_container" ng-click="slideTogglePlacesFilter=!slideTogglePlacesFilter; !slideToggleSpotsFilter && (slideToggleSpotsFilter=!slideToggleSpotsFilter)">
                        <div class="search_dropdown">
                            <span class="search_dropdown_label">Filtrer les hébergements</span>
                            <span class="search_dropdown_selectedValues">{{positions.length}}
                                résultat</span>
                            <i class="fa fa-caret-down" ng-hide="!slideTogglePlacesFilter"></i>
                            <i class="fa fa-caret-up" ng-hide="slideTogglePlacesFilter"></i>
                        </div>
                    </div>
                </li>
                <li ng-show="showSpot">
                    <div class="search_element_container" ng-click="slideToggleSpotsFilter=!slideToggleSpotsFilter; !slideTogglePlacesFilter && (slideTogglePlacesFilter=!slideTogglePlacesFilter);">
                        <div class="search_dropdown">
                            <span class="search_dropdown_label">Filtrer les spots</span>
                            <span class="search_dropdown_selectedValues">{{positions.length}}
                                résultat</span>
                            <i class="fa fa-caret-down" ng-hide="!slideToggleSpotsFilter"></i>
                            <i class="fa fa-caret-up" ng-hide="slideToggleSpotsFilter"></i>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="nav-wrapper search-nav" ng-hide="!showPlace || slideTogglePlacesFilter">
            <ul>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown' href='javascript:void(0);' data-hover="true" data-beloworigin="true" data-alignment="bottom" data-activates='propertyTypeDropdown' dropdown>
                            <span class="search_dropdown_label">Type de logement</span>
                            <span class="search_dropdown_selectedValues" ng-hide="selectedPropertyType.length > 0">Tous</span>
                            <span class="search_dropdown_selectedValues" ng-repeat='propertyType in selectedPropertyType'>{{propertyType}}</span>
                            <span class="search_dropdown_selectedValues" ng-show="selectedPropertyType.length > 3">...</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                        <ul id='propertyTypeDropdown' class='dropdown-content'>
                            <li ng-repeat="propertyType in propertyTypeListing" ng-click="toggleSelectedPropertyType(propertyType)">
                                <span>
                                    <input type="checkbox" value="{{propertyType}}" ng-click="toggleSelectedPropertyType(propertyType)" ng-checked="selectedPropertyType.indexOf(propertyType) > -1" id="{{propertyType}}"/>
                                    <label for="{{propertyType}}">{{propertyType}}</label>
                                </span>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown' href='javascript:void(0);' data-hover="true" data-beloworigin="true" data-alignment="bottom" data-activates='travellersDropdown' dropdown>
                            <span class="search_dropdown_label">Voyageurs</span>
                            <span class="search_dropdown_selectedValues" ng-hide="filters.home.travellers">Tous</span>
                            <span class="search_dropdown_selectedValues" ng-show='filters.home.travellers'>{{filters.home.travellers}}</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                        <ul id='travellersDropdown' class='dropdown-content'>
                            <li ng-click="filters.home.travellers = 1;">
                                <span>
                                    <input name="travellers" type="radio" ng-click="filters.home.travellers = 1" ng-checked="filters.home.travellers == 1" id="1traveller"/>
                                    <label for="1traveller">1 voyageur</label>
                                </span>
                            </li>
                            <li ng-click="filters.home.travellers = 2;">
                                <span>
                                    <input name="travellers" type="radio" ng-click="filters.home.travellers = 2" ng-checked="filters.home.travellers == 2" id="2traveller"/>
                                    <label for="2traveller">2 voyageur</label>
                                </span>
                            </li>
                            <li ng-click="filters.home.travellers = 3;">
                                <span>
                                    <input name="travellers" type="radio" ng-click="filters.home.travellers = 3" ng-checked="filters.home.travellers == 3" id="3traveller"/>
                                    <label for="3traveller">3 voyageur</label>
                                </span>
                            </li>
                            <li ng-click="filters.home.travellers = 4;">
                                <span>
                                    <input name="travellers" type="radio" ng-click="filters.home.travellers = 4" ng-checked="filters.home.travellers == 4" id="4traveller"/>
                                    <label for="4traveller">4 voyageur</label>
                                </span>
                            </li>
                            <li ng-click="filters.home.travellers = 5;">
                                <span>
                                    <input name="travellers" type="radio" ng-click="filters.home.travellers = 5" ng-checked="filters.home.travellers == 5" id="5traveller"/>
                                    <label for="5traveller">5 voyageur</label>
                                </span>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class="search_dropdown">
                            <span class="search_dropdown_label">Prix</span>
                            <span class="search_dropdown_selectedValues search_range_number center">{{price.min}}</span>
                            <span range-slider min="0" max="1000" model-min="price.min" model-max="price.max" filter="currency:'€'" step="10" show-values="false"></span>
                            <span class="search_dropdown_selectedValues search_range_number center">{{price.max}}</span>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class="search_dropdown">
                            <div class="switch">
                                <label>
                                    <span class="search_switch_label">Partagé</span>
                                    <input type="checkbox">
                                    <span class="lever"></span>
                                    <span class="search_switch_label">Privé</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="nav-wrapper search-nav" ng-hide="!showSpot || slideToggleSpotsFilter">
            <ul>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown'>
                            <span class="search_dropdown_label">
                                <img src='/assets/hobbies/quality.png' width='18px' height='18px'/>
                                Qualité</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown'>
                            <span class="search_dropdown_label">
                                <img src='/assets/hobbies/beauty.png' width='18px' height='18px'/>
                                Beauté</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown'>
                            <span class="search_dropdown_label">
                                <img src='/assets/hobbies/facility.png' width='18px' height='18px'/>
                                Difficulté</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown'>
                            <span class="search_dropdown_label">
                                <i class="icon-value-gris"></i>Popularité</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="search_element_container">
                        <div class='dropdown-button search_dropdown'>
                            <span class="search_dropdown_label">
                                <i class="icon-star"></i>Note globale</span>
                            <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
</div>
<div class="row search-container">
    <div class="col s7 search-left-col">
        <div id="widgets" class="row">
            <div class="col s12 m12 l6" dir-paginate="p in positions | filter : filters | hobbyFilter:selectedHobby | betweenLat:latitude.min:latitude.max | betweenLon:longitude.min:longitude.max | betweenPrice:price.min:price.max | itemsPerPage: 8">
                <a href="/place/{{p._id}}" ng-mouseover="getHoveredPlaceIndex($index, true);" ng-mouseleave="getHoveredPlaceIndex($index, false);" target="_blank">
                    <div class="card">
                        <div class="card-image">
                            <div class="placepict" ng-style="{'background-image': 'url(uploads/places/{{p._id}}/thumb/{{p.pictures[0]}})', 'background-size': 'cover'}"></div>
                            <span class="card-title">{{p.home.price|currency:'€'}}</span>
                        </div>
                        <div class="card-content">
                            <p>
                                <img class="actpict" src="assets/hobbies/{{p.hobbies[0]}}.png" alt=""/>
                                <img class="authorpict" src="./assets/hobbynaut-avatar.gif" ng-show="!p.owner.picture"/>
                                <img class="authorpict" ng-src="{{'/uploads/users/'+p.owner._id+'/thumb/'+p.owner.picture}}" ng-show="p.owner.picture"/>
                                <div>{{p.name}}</div>
                                <div>
                                    <star-rating ng-model="p.rating.valueForMoney" readonly="true"></star-rating>
                                    <sup>({{p.rating.numberOfRatings}})</sup>
                                </div>
                            </p>
                        </div>
                    </div>
                </a>
            </div>
            <dir-pagination-controls></dir-pagination-controls>
        </div>
    </div>

    <div class="col s5 search-rigth-col">
        <ng-map default-style="false" center="{{centerMap}}" geo-fallback-center="48.8534100, 2.3488000" zoom="6" id="myMap" style='height:100%;'>
            <marker
                ng-repeat="p in positions | filter : filters | hobbyFilter:selectedHobby | betweenLat:latitude.min:latitude.max | betweenLon:longitude.min:longitude.max | betweenPrice:price.min:price.max | itemsPerPage: 8"
                position="[{{p.latitude}},{{p.longitude}}]"
                title={{p.shortDescription}}
                icon="{
                      url:'assets/search/tileHome.png',
                      scaledSize:[32,32],
                      origin: [0,0],
                      anchor: [16,32]
                      }"
                scrollwheel="true"
                animation="{{hoveredPlaceIndex == $index ? 'BOUNCE' : 'null'}}"
                on-click="toggleInfoWindow(event, p)"
                clickable="true"></marker>
            <info-window id="popup" max-width="200">
                <a href="/place/{{toggleledPlace._id}}" target="_blank">
                    <div class="card">
                        <div class="card-image">
                            <img src="/uploads/places/{{toggleledPlace._id}}/thumb/{{toggleledPlace.pictures[0]}}">
                            <span class="card-title" style="background-color: rgba(100,100,100,0.5); padding:2px;">{{toggleledPlace.home.price}}€</span>
                        </div>
                        <div class="card-content">
                            <p>
                                <div>{{toggleledPlace.name}}</div>
                                <div>
                                    <star-rating ng-model="toggleledPlace.rating.valueForMoney" readonly="true"></star-rating>
                                    <sup>({{p.rating.numberOfRatings}})</sup>
                                </div>
                            </p>
                        </div>
                    </div>
                </a>
            </info-window>
        </ng-map>
    </div>
</div>
